<!doctype html><html lang=pt-br><head><title>Estruturando um projeto Terraform pt1 ¬∑ nivaldogmelo
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="Nivaldo Melo"><meta name=description content="Um guia para como estruturar o terraform dentro do seu time"><meta name=keywords content="blog,desenvolvedor,pessoal"><meta name=twitter:card content="summary"><meta name=twitter:title content="Estruturando um projeto Terraform pt1"><meta name=twitter:description content="Um guia para como estruturar o terraform dentro do seu time"><meta property="og:url" content="https://nivaldogmelo.github.io/pt-br/posts/structuring-terraform.pt1/"><meta property="og:site_name" content="nivaldogmelo"><meta property="og:title" content="Estruturando um projeto Terraform pt1"><meta property="og:description" content="Um guia para como estruturar o terraform dentro do seu time"><meta property="og:locale" content="pt_br"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-08-13T00:00:00+00:00"><meta property="article:modified_time" content="2024-08-13T00:00:00+00:00"><meta property="article:tag" content="Golang"><meta property="article:tag" content="Terraform"><link rel=canonical href=https://nivaldogmelo.github.io/pt-br/posts/structuring-terraform.pt1/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.36f76aaf39a14ecf5c3a3c6250dcaf06c238b3d8365d17d646f95cb1874e852b.css integrity="sha256-NvdqrzmhTs9cOjxiUNyvBsI4s9g2XRfWRvlcsYdOhSs=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.593028e7f7ac55c003b79c230d1cd411bb4ca53b31556c3abb7f027170e646e9.css integrity="sha256-WTAo5/esVcADt5wjDRzUEbtMpTsxVWw6u38CcXDmRuk=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/custom.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css integrity="sha256-47DEQpj8HBSa+/TImW+5JCeuQeRkm5NMpJWZG3hSuFU=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/images/favicon.svg sizes=any><link rel=icon type=image/png href=/img/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/img/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://nivaldogmelo.github.io/pt-br/>nivaldogmelo
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/pt-br/about/>Sobre</a></li><li class=navigation-item><a class=navigation-link href=/pt-br/posts/>Blog</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class=navigation-item><a href=/>üá¨üáß</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://nivaldogmelo.github.io/pt-br/posts/structuring-terraform.pt1/>Estruturando um projeto Terraform pt1</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2024-08-13T00:00:00Z>agosto 13, 2024
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
6 minutos de leitura</span></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=/pt-br/tags/golang/>Golang</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/pt-br/tags/terraform/>Terraform</a></span></div></div></header><div class=post-content><h2 id=estruturando-projetos-terraform-pt1>Estruturando projetos Terraform Pt.1
<a class=heading-link href=#estruturando-projetos-terraform-pt1><i class="fa-solid fa-link" aria-hidden=true title="Link para o cabe√ßalho"></i>
<span class=sr-only>Link para o cabe√ßalho</span></a></h2><p>Como sabemos o Terraform √© uma das ferramentas mais populares quando se trata de Infraestrutura como c√≥digo (IAC) declarativa. Por√©m algo que sempre me deixou um pouco perdido foi como estruturar meus projetos de maneira eficiente. N√£o √© dif√≠cil achar um tutorial de boas pr√°ticas de como devemos nomear recursos, por√©m saber como organizar suas pastas pode ser um pouco mais desafiador. Devo usar m√≥dulos? Workspaces? At√© onde devo agregar os recursos em um √∫nico arquivo <code>.tf</code>?</p><p>A partir disso escrevi um modelo de estrutura para o c√≥digo terraform, que engloba funcionalidades que na minha opini√£o s√£o essenciais em um projeto. Esse modelo √© composto por quatro pilares:</p><ul><li><strong>M√≥dulos</strong>: Utilizados para agregar servi√ßos que funcionam como uma unidade (Mais detalhes a frente), dessa forma reduziremos a repeti√ß√£o de c√≥digos.</li><li><strong>Exemplos</strong>: Aqui ser√£o definidos exemplos de uso para facilitar a ado√ß√£o por outros membros do time.</li><li><strong>Testes Unit√°rios</strong>: Para conseguirmos detectar falhas o mais cedo poss√≠vel no desenvolvimento</li><li><strong>Documenta√ß√£o</strong>: Tentaremos deixar o processo de documentar o mais suave poss√≠vel de forma que fique f√°cil para que outras pessoas da empresa consigam adotar os arquivos.</li></ul><p>Vamos come√ßar ent√£o explicando o motivo pela escolha desses pilares.</p><hr><h3 id=m√≥dulos>M√≥dulos
<a class=heading-link href=#m%c3%b3dulos><i class="fa-solid fa-link" aria-hidden=true title="Link para o cabe√ßalho"></i>
<span class=sr-only>Link para o cabe√ßalho</span></a></h3><p>Como muitos j√° sabem, um m√≥dulo no Terraform √© uma forma de melhorar a reutiliza√ß√£o de c√≥digo, isso √© feito atrav√©s da agrega√ß√£o de recursos que s√£o frequentemente criados juntos. Fazendo isso conseguimos centralizar a configura√ß√£o em um √∫nico lugar, tornando altera√ß√≥es em massa mais f√°ceis e eficientes. Algo importante a ser considerado √© que quando escrevendo m√≥dulos outras pessoas podem estar dependendo do seu c√≥digo, por isso √© importante levar em considera√ß√£o antes de realizar uma altera√ß√£o que possa levar a incompatibilidade.</p><h3 id=exemplos>Exemplos
<a class=heading-link href=#exemplos><i class="fa-solid fa-link" aria-hidden=true title="Link para o cabe√ßalho"></i>
<span class=sr-only>Link para o cabe√ßalho</span></a></h3><p>Todos os exemplos devem ter uso pr√°tico, tornando f√°cil para os leitores verem como podem ser aplicados em seus pr√≥prios ambientes.</p><h3 id=testes-unit√°rios>Testes Unit√°rios
<a class=heading-link href=#testes-unit%c3%a1rios><i class="fa-solid fa-link" aria-hidden=true title="Link para o cabe√ßalho"></i>
<span class=sr-only>Link para o cabe√ßalho</span></a></h3><p>Testes em infraestrutura costumam ser incomuns devido ao potencial de gastos, por√©m se feitos em um ambiente controlado podem facilitar bastante o desenvolvimento e manutenabilidade do seu c√≥digo. Neles podemos ter descritos os cen√°rios mais importantes aos quais os m√≥dulo devem cobrir, dessa forma evitando altera√ß√µes que gerem incompatibilidade. Outra vantagem √© que tendo os cen√°rios documentado nos testes n√£o precisamos nos preocupar com algu√©m testando manualmente todos os cen√°rios, o que pode levar a erros.</p><h3 id=documenta√ß√£o>Documenta√ß√£o
<a class=heading-link href=#documenta%c3%a7%c3%a3o><i class="fa-solid fa-link" aria-hidden=true title="Link para o cabe√ßalho"></i>
<span class=sr-only>Link para o cabe√ßalho</span></a></h3><p>Por √∫ltimo mas n√£o menos importante, temos a etapa da documenta√ß√£o. Uma boa documenta√ß√£o torna mais f√°cil para outros times entenderem e adotarem seu produto. Por√©m se feita manualmente toda vez, √© f√°cil perder controle das coisas, levando a uma documenta√ß√£o desatualizada e dif√≠cil de seguir. Por isso n√≥s procuramos tornar o processo de documentar o mais suave poss√≠vel, garantindo que esteja sempre de acordo com o c√≥digo no projeto.</p><h2 id=onde-queremos-chegar>Onde queremos chegar
<a class=heading-link href=#onde-queremos-chegar><i class="fa-solid fa-link" aria-hidden=true title="Link para o cabe√ßalho"></i>
<span class=sr-only>Link para o cabe√ßalho</span></a></h2><p>Por fim segue a estrutura de reposit√≥rio onde queremos chegar, observe que temos alguns arquivos <code>go</code> pois √© a linguagem que vamos utilizar para escrever os testes unit√°rios</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>terraform-modules-structure
</span></span><span style=display:flex><span>‚îú‚îÄ‚îÄ examples/
</span></span><span style=display:flex><span>‚îú‚îÄ‚îÄ go.mod
</span></span><span style=display:flex><span>‚îú‚îÄ‚îÄ go.sum
</span></span><span style=display:flex><span>‚îú‚îÄ‚îÄ modules/
</span></span><span style=display:flex><span>‚îú‚îÄ‚îÄ README.md
</span></span><span style=display:flex><span>‚îî‚îÄ‚îÄ test/
</span></span></code></pre></div><hr><h2 id=escrevendo-o-c√≥digo>Escrevendo o c√≥digo
<a class=heading-link href=#escrevendo-o-c%c3%b3digo><i class="fa-solid fa-link" aria-hidden=true title="Link para o cabe√ßalho"></i>
<span class=sr-only>Link para o cabe√ßalho</span></a></h2><p>Antes de come√ßar vamos ent√£o definir o tipo de servi√ßo que queremos subir. Para esse exemplo vamos criar uma Cloud Function no GCP. Em uma cloud Function podemos escolher alguns tipos de fontes para armazenar o nosso c√≥digo fonte; para esse exemplo vamos utilizar um Bucket no GCS. Ent√£o segue a estrutura:</p><pre tabindex=0><code class=language-mermaid data-lang=mermaid>  graph TD;
	  CF--&gt;Bucket;
</code></pre><h3 id=inicializando-o-reposit√≥rio>Inicializando o Reposit√≥rio
<a class=heading-link href=#inicializando-o-reposit%c3%b3rio><i class="fa-solid fa-link" aria-hidden=true title="Link para o cabe√ßalho"></i>
<span class=sr-only>Link para o cabe√ßalho</span></a></h3><p>Essa parte √© bem simples, a princ√≠pio s√≥ precisamos iniciar um projeto golang, o que pode ser feito da seguinte forma</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‚ùØ mkdir terraform-modules-structure <span style=color:#ff79c6>&amp;&amp;</span> <span style=color:#8be9fd;font-style:italic>cd</span> terraform-modules-structure
</span></span><span style=display:flex><span>‚ùØ go mod init terraform-modules-structure
</span></span></code></pre></div><p>Observe que nomeei meu projeto como <code>terraform-modules-structure</code>, mas fique livre pra nomear como preferir.</p><h3 id=exemplos-1>Exemplos
<a class=heading-link href=#exemplos-1><i class="fa-solid fa-link" aria-hidden=true title="Link para o cabe√ßalho"></i>
<span class=sr-only>Link para o cabe√ßalho</span></a></h3><p>Eu diria que aqui √© a parte mais importante do projeto, nessa parte vamos definir os exemplos de uso do m√≥dulo, pensando em como os usu√°rios finais v√£o interagir com nossos m√≥dulos. Por isso √© importante que os exemplos sejam claros, pr√°ticos e est√°veis, pois caso contr√°rio a ado√ß√£o do projeto pode ser comprometida.</p><p>Pensando do ponto de vista do usu√°rio final. Vamos decidir quais par√¢metros fazem sentido controlarmos e quais n√£o.</p><p>Olhando o seguinte <a href=https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/cloudfunctions2_function#example-usage---cloudfunctions2-basic class=external-link target=_blank rel=noopener>exemplo</a> vamos propor que o usu√°rio possa ter controle nos seguintes par√¢metros:</p><ul><li>nome da func√£o</li><li>regi√£o</li><li>descri√ß√£o</li><li>runtime</li><li>entry_point</li><li>max_instance</li><li>mem√≥ria</li><li>timeout</li></ul><p>O restante pode ser definido no pr√≥prio m√≥dulo, inclu√≠ndo a integra√ß√£o com o bucket.</p><h4 id=arquivos-terraform>Arquivos Terraform
<a class=heading-link href=#arquivos-terraform><i class="fa-solid fa-link" aria-hidden=true title="Link para o cabe√ßalho"></i>
<span class=sr-only>Link para o cabe√ßalho</span></a></h4><p>Ent√£o vamos come√ßar a criar esses arquivos</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‚ùØ mkdir -p examples/gcp/cloud-function-v2
</span></span><span style=display:flex><span>‚ùØ touch examples/gcp/cloud-function-v2/main.tf
</span></span></code></pre></div><p>No <code>main.tf</code> vamos preencher:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#ff79c6>module</span> <span style=color:#f1fa8c>&#34;function&#34;</span> {
</span></span><span style=display:flex><span>  source <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;../../modules/gcp/cloud-function-v2&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  name        <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;my-function&#34;</span>
</span></span><span style=display:flex><span>  description <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;My function&#34;</span>
</span></span><span style=display:flex><span>  region      <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;us-central1&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  runtime     <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;nodejs16&#34;</span>
</span></span><span style=display:flex><span>  entry_point <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;helloGET&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  source_path <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;./src&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  max_instances <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>
</span></span><span style=display:flex><span>  memory        <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>256</span>
</span></span><span style=display:flex><span>  timeout       <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>60</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=inserindo-c√≥digo-para-fun√ß√£o>Inserindo c√≥digo para fun√ß√£o
<a class=heading-link href=#inserindo-c%c3%b3digo-para-fun%c3%a7%c3%a3o><i class="fa-solid fa-link" aria-hidden=true title="Link para o cabe√ßalho"></i>
<span class=sr-only>Link para o cabe√ßalho</span></a></h4><p>Vamos criar uma fun√ß√£o para conseguir fazer deploy da mesma, para isso vamos usar o exemplo na pr√≥pria documenta√ß√£o oficial do google, para encaixar o mesmo na nossa estrutura basta fazer o seguinte:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‚ùØ mkdir examples/gcp/cloud-function-v2/src
</span></span><span style=display:flex><span>‚ùØ touch examples/gcp/cloud-function-v2/src/index.js
</span></span><span style=display:flex><span>‚ùØ touch examples/gcp/cloud-function-v2/src/package.json
</span></span></code></pre></div><p>e preencher com o seguinte no <code>index.js</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#ff79c6>const</span> functions <span style=color:#ff79c6>=</span> require(<span style=color:#f1fa8c>&#39;@google-cloud/functions-framework&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4>// Register an HTTP function with the Functions Framework that will be executed
</span></span></span><span style=display:flex><span><span style=color:#6272a4>// when you make an HTTP request to the deployed function&#39;s endpoint.
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>functions.http(<span style=color:#f1fa8c>&#39;helloGET&#39;</span>, (req, res) =&gt; {
</span></span><span style=display:flex><span>  res.send(<span style=color:#f1fa8c>&#39;Hello World!&#39;</span>);
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><p>e no <code>package.json</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>&#34;name&#34;</span>: <span style=color:#f1fa8c>&#34;nodejs-docs-samples-functions-hello-world-get&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>&#34;version&#34;</span>: <span style=color:#f1fa8c>&#34;0.0.1&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>&#34;private&#34;</span>: <span style=color:#ff79c6>true</span>,
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>&#34;license&#34;</span>: <span style=color:#f1fa8c>&#34;Apache-2.0&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>&#34;author&#34;</span>: <span style=color:#f1fa8c>&#34;Google Inc.&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>&#34;repository&#34;</span>: {
</span></span><span style=display:flex><span>	<span style=color:#ff79c6>&#34;type&#34;</span>: <span style=color:#f1fa8c>&#34;git&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#ff79c6>&#34;url&#34;</span>: <span style=color:#f1fa8c>&#34;https://github.com/GoogleCloudPlatform/nodejs-docs-samples.git&#34;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>&#34;engines&#34;</span>: {
</span></span><span style=display:flex><span>	<span style=color:#ff79c6>&#34;node&#34;</span>: <span style=color:#f1fa8c>&#34;&gt;=16.0.0&#34;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>&#34;scripts&#34;</span>: {
</span></span><span style=display:flex><span>	<span style=color:#ff79c6>&#34;test&#34;</span>: <span style=color:#f1fa8c>&#34;c8 mocha -p -j 2 test/*.test.js --timeout=6000 --exit&#34;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>&#34;dependencies&#34;</span>: {
</span></span><span style=display:flex><span>	<span style=color:#ff79c6>&#34;@google-cloud/functions-framework&#34;</span>: <span style=color:#f1fa8c>&#34;^3.1.0&#34;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>&#34;devDependencies&#34;</span>: {
</span></span><span style=display:flex><span>	<span style=color:#ff79c6>&#34;c8&#34;</span>: <span style=color:#f1fa8c>&#34;^8.0.0&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#ff79c6>&#34;gaxios&#34;</span>: <span style=color:#f1fa8c>&#34;^6.0.0&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#ff79c6>&#34;mocha&#34;</span>: <span style=color:#f1fa8c>&#34;^10.0.0&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#ff79c6>&#34;wait-port&#34;</span>: <span style=color:#f1fa8c>&#34;^1.0.4&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>√ìtimo! Agora temos um caso de uso, s√≥ falta documentar o mesmo.</p><h4 id=documenta√ß√£o-1>Documenta√ß√£o
<a class=heading-link href=#documenta%c3%a7%c3%a3o-1><i class="fa-solid fa-link" aria-hidden=true title="Link para o cabe√ßalho"></i>
<span class=sr-only>Link para o cabe√ßalho</span></a></h4><p>Agora que temos um caso de uso, √© interessante fornecer um README explicando como se utilizar, dessa forma tornando a ado√ß√£o mais f√°cil. Para isso vamos utilizar uma ferramenta chamada <a href=https://terraform-docs.io/user-guide/introduction/ class=external-link target=_blank rel=noopener>terraform-docs</a>. Ap√≥s o instalar vamos configurar o seguinte:</p><p>Primeiro criamos o arquivo <code>examples/.terraform-docs.yml</code>, o qual vai fornecer uma estrutura base para ser utilizada em todos os exemplos.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>formatter: &#34;markdown table&#34;
</span></span><span style=display:flex><span>header-from: header.md # Indicamos de onde vir√° o conte√∫do para servir de header do readme
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>content: |-
</span></span><span style=display:flex><span>  {{ .Header }}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  ```hcl
</span></span><span style=display:flex><span>  {{ include &#34;main.tf&#34; }}
</span></span><span style=display:flex><span>  ```
</span></span></code></pre></div><p>Ap√≥s isso criamos o arquivo <code>examples/gcp/cloud-function-v2/header.md</code>, aqui escrevemos um header espec√≠fico para o nosso exemplo, nesse caso:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span><span style=font-weight:700>## Criando uma Cloud Function
</span></span></span><span style=display:flex><span><span style=font-weight:700></span>
</span></span><span style=display:flex><span>Esse exemplo demonstra como criar uma Cloud Function no GCP via Terraform. O exemplo ir√° comprimir o c√≥digo dentro da pasta <span style=color:#f1fa8c>`src/`</span> e o salvar em um bucket no GCS.
</span></span></code></pre></div><p>Por fim basta executarmos o seguinte para gerar nosso README:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‚ùØ <span style=color:#8be9fd;font-style:italic>cd</span> examples/gcp/cloud-function-v2
</span></span><span style=display:flex><span>‚ùØ terraform-docs -c ../../.terraform-docs.yml .
</span></span></code></pre></div><p>Com isso temos um caso de uso documentado e um processo para regerar com base no nosso c√≥digo. Para automatizar o processo basta adicionar o mesmo no seu CI.</p><h2 id=pr√≥ximos-passos>Pr√≥ximos passos
<a class=heading-link href=#pr%c3%b3ximos-passos><i class="fa-solid fa-link" aria-hidden=true title="Link para o cabe√ßalho"></i>
<span class=sr-only>Link para o cabe√ßalho</span></a></h2><p>Na pr√≥xima parte vamos escrever um teste unit√°rio tomando nosso exemplo como base.</p></div><footer></footer></article></section></div><footer class=footer><section class=container>¬©
2019 -
2024
Nivaldo Melo
¬∑
Promovido por <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>